<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8" />
    <title>AX5UI - Paging</title>
    <link rel="stylesheet" type="text/css" href="https://cdn.rawgit.com/ax5ui/ax5ui-kernel/master/dist/ax5ui.all.css">
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script type="text/javascript" src="https://cdn.rawgit.com/ax5ui/ax5ui-kernel/master/dist/ax5ui.all.min.js"></script>
    <script type="text/javascript">
        //<![CDATA
        var firstGrid = null;

        $(function() {
            /* dash(-)로 구분되는 날짜 포맷터 */
            ax5.ui.grid.formatter["date"] = function() {
                var date = this.value;
                if (date.length == 8) {
                    return date.substr(0, 4) + "-" + date.substr(4, 2) + "-" + date.substr(6);
                } else {
                    return date;
                }
            }

            /* 그리드 객체 생성 */
            firstGrid = new ax5.ui.grid();

            /* 그리드 설정 지정 */
            firstGrid.setConfig({
                target: $('[data-ax5grid="first-grid"]'),

                //showLineNumber: false,
                showLineNumber: false,
                //showRowSelector: true,
                showRowSelector: false,
                multipleSelect: false,
                lineNumberColumnWidth: 40,
                rowSelectorColumnWidth: 27,

                columns: [{
                        key: "seq",
                        label: "순번",
                        align: "center",
                        editor: {
                            type: "date"
                        }
                    },
                    {
                        key: "date",
                        label: "날짜",
                        formatter: "date",
                        align: "center",
                        editor: {
                            type: "date"
                        }
                    },
                    {
                        key: "type",
                        label: "구분",
                        align: "center",
                        editor: {
                            type: "select",
                            config: {
                                columnKeys: {
                                    optionValue: "CD",
                                    optionText: "NM"
                                },
                                options: [{
                                        CD: "O",
                                        NM: "O: 주유"
                                    },
                                    {
                                        CD: "R",
                                        NM: "R: 정비"
                                    }
                                ]
                            },
                            disabled: function() {
                                // 활성화 여부를 item.complete 의 값으로 런타임 판단.
                                return this.item.complete == "true";
                            }
                        }
                    },
                    {
                        key: "amount",
                        label: "<strong>주유량</strong>",
                        align: "center",
                        editor: {
                            type: "number"
                        }
                    },
                    {
                        key: "mileage",
                        label: "주행거리(km)",
                        align: "center",
                        editor: {
                            type: "number"
                        }
                    },
                    {
                        key: "price",
                        label: "금액(원)",
                        formatter: "money",
                        align: "center",
                        editor: {
                            type: "money"
                        }
                    },
                    {
                        key: "repair",
                        label: "정비내역",
                        align: "center",
                        editor: {
                            type: "text"
                        }
                    },
                    {
                        key: "complete",
                        label: "완료",
                        align: "center",
                        editor: {
                            type: "checkbox"
                        }
                    },
                    {
                        key: "note",
                        label: "비고",
                        align: "center",
                        editor: {
                            type: "textarea"
                        }
                    }
                ],
                page: {
                    navigationItemCount: 9,
                    height: 30,
                    display: true,
                    firstIcon: '|<',
                    prevIcon: '<',
                    nextIcon: '>',
                    lastIcon: '>|',
                    onChange: function() {
                        // 페이지 번호 눌렀을때 호출
                        search(this.page.selectPage);
                    }
                },
            });

            var list = [];
            for (var i = 0; i < 100; i++) {
                list.push({
                    seq: i,
                    date: "20170102",
                    type: "R",
                    amount: 25,
                    mileage: (i + 1) * 100,
                    price: 45000,
                    repair: "-",
                    complete: "true",
                    note: "-"
                });
            }

            //firstGrid.setData(list);

            /*
            firstGrid.setData( { 
            list: list, 
            page: 
            	{ 
            		//currentPage: _pageNo, 
            		currentPage: 0, 
            		pageSize: 5, 
            		totalElements: 30, 
            		totalPages: 5 
            	} 
            });
            */


            search(0);

            //firstGrid.setData(list);
        });


        function search(_pageNo) {
            console.log('eq : ' + _pageNo);
            var list = [];

            // 리스트 안변하는거 같아서 pageNo 붙여서 변화되는거 확인
            for (var i = 0; i < 10; i++) {
                list.push({
                    seq: _pageNo * 10 + i,
                    date: "20170102" + _pageNo,
                    type: "R",
                    amount: 25,
                    mileage: (i + 1) * 100,
                    price: 45000,
                    repair: "-",
                    complete: "true",
                    note: "-"
                });
            }

            firstGrid.setData({
                list: list,
                page: {
                    currentPage: _pageNo,
                    pageSize: 10,
                    totalElements: 500,
                    totalPages: 50000
                }
            });
        }
        //]]>
    </script>
</head>

<body>
    <h3>AX5UI Grid <button onclick="search(0);">조회</button>
    </h3>
    <div data-ax5grid="first-grid" data-ax5grid-config="{}" style="width:100%; height:350px;"></div>
</body>

</html>